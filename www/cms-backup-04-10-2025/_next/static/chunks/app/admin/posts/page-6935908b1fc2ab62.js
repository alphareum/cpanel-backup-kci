(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{2945:function(e,t,l){Promise.resolve().then(l.bind(l,7278))},7278:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return d}});var s=l(7573),a=l(7653),i=l(8428),n=l(3978),r=l(7656);function o(){return{title:"",slug:"",summary:"",body:"",cover_image_url:"",published_at:"",is_published:!1}}function d(){let e="/posts?includeDrafts=1",{data:t,error:l,isLoading:d,mutate:c}=(0,i.ZP)(e,()=>(0,r.R1)(e)),u=(0,a.useMemo)(()=>{var e;return null!==(e=null==t?void 0:t.posts)&&void 0!==e?e:[]},[t]),[h,m]=(0,a.useState)(!1),[p,b]=(0,a.useState)(""),[g,x]=(0,a.useState)(!1),[y,v]=(0,a.useState)(()=>o()),[j,f]=(0,a.useState)(null),[_,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null);function S(){m(!1),x(!1),b("")}function C(e,t){v(l=>({...l,[e]:t}))}async function T(e){e.preventDefault(),x(!0),b("");let t={id:null!=j?j:void 0,title:y.title,slug:y.slug,summary:y.summary||null,body:y.body,cover_image_url:y.cover_image_url||null,is_published:y.is_published,published_at:function(e){if(!e)return null;let t=new Date("".concat(e,"T00:00:00.000Z"));return Number.isNaN(t.getTime())?null:t.toISOString()}(y.published_at)};try{await (0,r.sg)("/posts",t),await c(),S()}catch(e){b(e.message||"Failed to save post")}finally{x(!1)}}async function D(e){let t=!e.is_published,l=t?e.published_at||new Date().toISOString():e.published_at||null;try{var s,a;await (0,r.sg)("/posts",{id:e.id,title:e.title,slug:e.slug,summary:null!==(s=e.summary)&&void 0!==s?s:null,body:e.body,cover_image_url:null!==(a=e.cover_image_url)&&void 0!==a?a:null,is_published:t,published_at:l}),await c()}catch(e){alert(e.message||"Failed to update publish status")}}async function P(e){if(window.confirm('Delete post "'.concat(e.title,'"? This action cannot be undone.'))){k(e.id);try{await (0,r.QW)("/posts/".concat(e.id)),await c()}catch(e){alert(e.message||"Failed to delete post")}finally{k(null)}}}return(0,s.jsxs)("section",{children:[(0,s.jsxs)("header",{className:"action-bar",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{style:{margin:0},children:"Posts"}),(0,s.jsx)("p",{style:{margin:0,color:"#555"},children:"Create and manage blog entries. Publish posts to make them visible on the public blog."})]}),(0,s.jsx)("button",{className:"button",onClick:function(){v(o()),f(null),b(""),m(!0)},children:"New post"})]}),l?(0,s.jsx)("div",{className:"alert",children:l.message}):null,d?(0,s.jsx)("p",{children:"Loading posts…"}):0===u.length?(0,s.jsx)("div",{className:"empty-state",children:"No posts yet. Start by creating a new post."}):(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Title"}),(0,s.jsx)("th",{children:"Published on"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:u.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"stack",children:[(0,s.jsx)("strong",{children:e.title}),(0,s.jsx)("span",{style:{color:"#666",fontSize:"0.875rem"},children:e.slug})]})}),(0,s.jsx)("td",{children:e.published_at?new Date(e.published_at).toLocaleDateString("en-US",{timeZone:"Asia/Jakarta"}):"—"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge",style:{background:e.is_published?"#dcfce7":"#fee2e2",color:e.is_published?"#166534":"#7f1d1d"},children:e.is_published?"Published":"Draft"})}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,s.jsx)("button",{className:"button secondary",onClick:()=>{var t,l,s;v({...e,summary:null!==(t=e.summary)&&void 0!==t?t:"",body:null!==(l=e.body)&&void 0!==l?l:"",cover_image_url:null!==(s=e.cover_image_url)&&void 0!==s?s:"",published_at:function(e){if(!e)return"";let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let l=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return"".concat(l,"-").concat(s,"-").concat(a)}(e.published_at)}),f(e.id),b(""),m(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"button",onClick:()=>D(e),children:e.is_published?"Unpublish":"Publish"}),(0,s.jsx)("button",{className:"button secondary",onClick:()=>P(e),disabled:w===e.id,children:w===e.id?"Deleting…":"Delete"})]})})]},e.id))})]}),h?(0,s.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"modal",style:{maxWidth:"720px"},children:[(0,s.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[(0,s.jsx)("h2",{style:{margin:0},children:j?"Edit post":"Create post"}),(0,s.jsx)("p",{style:{margin:0,color:"#555"},children:"Provide the post details below. The publish date helps order posts on the public blog."})]}),p?(0,s.jsx)("div",{className:"alert",children:p}):null,(0,s.jsxs)("form",{className:"form-grid",onSubmit:T,children:[(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"title",children:"Title"}),(0,s.jsx)("input",{id:"title",type:"text",required:!0,value:y.title,onChange:e=>C("title",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"slug",children:"Slug"}),(0,s.jsx)("input",{id:"slug",type:"text",required:!0,value:y.slug,onChange:e=>C("slug",e.target.value)})]})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"summary",children:"Summary"}),(0,s.jsx)("textarea",{id:"summary",rows:3,value:y.summary,onChange:e=>C("summary",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"body",children:"Body"}),(0,s.jsx)("textarea",{id:"body",rows:10,required:!0,value:y.body,onChange:e=>C("body",e.target.value)})]}),(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"published_at",children:"Publish date"}),(0,s.jsx)("input",{id:"published_at",type:"date",value:y.published_at,onChange:e=>C("published_at",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"cover_image",children:"Cover image URL"}),(0,s.jsxs)("div",{className:"stack",style:{gap:"0.5rem"},children:[(0,s.jsx)("input",{id:"cover_image",type:"url",value:y.cover_image_url,onChange:e=>C("cover_image_url",e.target.value)}),(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,s.jsx)("button",{type:"button",className:"button secondary",onClick:()=>N(!0),children:"Choose from media library"}),y.cover_image_url?(0,s.jsx)("button",{type:"button",className:"button secondary",onClick:()=>C("cover_image_url",""),children:"Remove image"}):null]}),y.cover_image_url?(0,s.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.75rem",overflow:"hidden",width:"100%",maxWidth:"320px"},children:(0,s.jsx)("img",{src:y.cover_image_url,alt:"Selected cover",style:{width:"100%",display:"block",objectFit:"cover"}})}):null]})]})]}),(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,s.jsx)("input",{type:"checkbox",checked:y.is_published,onChange:e=>C("is_published",e.target.checked)}),(0,s.jsx)("span",{children:"Published"})]}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)("button",{type:"button",className:"button secondary",onClick:S,disabled:g,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"button",disabled:g,children:g?"Saving…":"Save post"})]})]})]})}):null,(0,s.jsx)(n.R,{open:_,onClose:()=>N(!1),onSelect:function(e){e&&(C("cover_image_url",e.asset_url||""),N(!1))}})]})}},3978:function(e,t,l){"use strict";l.d(t,{R:function(){return d}});var s=l(7573),a=l(7653),i=l(8428),n=l(7656);let r=[{value:"testimonial",label:"Testimonials"},{value:"partner",label:"Partners"},{value:"gallery",label:"Gallery"}];function o(e){let{type:t,onSelect:l}=e,{data:r,error:o,isLoading:d}=(0,i.ZP)("/media/".concat(t),()=>(0,n.R1)("/media/".concat(t))),c=(0,a.useMemo)(()=>{var e;return null!==(e=null==r?void 0:r.items)&&void 0!==e?e:[]},[r]);return o?(0,s.jsx)("div",{className:"alert",children:o.message}):d?(0,s.jsx)("p",{children:"Loading media…"}):0===c.length?(0,s.jsx)("div",{className:"empty-state",children:"No media in this group yet."}):(0,s.jsx)("div",{className:"stack",children:c.map(e=>(0,s.jsxs)("button",{type:"button",className:"card",style:{textAlign:"left",display:"grid",gridTemplateColumns:"96px 1fr auto",gap:"1rem",alignItems:"center"},onClick:()=>l(e),children:[(0,s.jsx)("div",{style:{width:"96px",height:"96px",borderRadius:"0.75rem",overflow:"hidden",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #e5e7eb"},children:e.asset_url?(0,s.jsx)("img",{src:e.asset_url,alt:e.title||"Media asset",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,s.jsx)("span",{style:{color:"#555"},children:"No preview"})}),(0,s.jsxs)("div",{className:"stack",style:{gap:"0.35rem"},children:[(0,s.jsx)("strong",{children:e.title||"Untitled asset"}),e.description?(0,s.jsx)("span",{style:{color:"#555"},children:e.description}):null,(0,s.jsx)("span",{style:{fontSize:"0.85rem",color:"#1f6feb",wordBreak:"break-all"},children:e.asset_url})]}),(0,s.jsx)("span",{className:"badge",style:{justifySelf:"flex-start"},children:"Select"})]},e.id))})}function d(e){var t,l;let{open:i,onClose:n,onSelect:d}=e,[c,u]=(0,a.useState)(null!==(l=null===(t=r[0])||void 0===t?void 0:t.value)&&void 0!==l?l:"testimonial");return((0,a.useEffect)(()=>{if(!i)return;let e=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,n]),i)?(0,s.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"modal",style:{maxWidth:"720px"},children:[(0,s.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[(0,s.jsx)("h2",{style:{margin:0},children:"Choose media"}),(0,s.jsx)("p",{style:{margin:0,color:"#555"},children:"Pick an image from the media library. You can manage assets from the Media section of the admin panel."})]}),(0,s.jsx)("div",{className:"tabs",role:"tablist",style:{marginBottom:"1rem"},children:r.map(e=>(0,s.jsx)("button",{type:"button",role:"tab","aria-selected":c===e.value,className:"tab ".concat(c===e.value?"active":""),onClick:()=>u(e.value),children:e.label},e.value))}),(0,s.jsx)("div",{style:{maxHeight:"420px",overflowY:"auto",paddingRight:"0.5rem"},children:(0,s.jsx)(o,{type:c,onSelect:e=>d(e)})}),(0,s.jsx)("footer",{style:{marginTop:"1rem",display:"flex",justifyContent:"flex-end"},children:(0,s.jsx)("button",{type:"button",className:"button secondary",onClick:n,children:"Close"})})]})}):null}},7656:function(e,t,l){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l="".concat("https://api.komunitaschineseindonesia.com/api").concat(e),s="undefined"!=typeof FormData&&t.body instanceof FormData?{...t.headers||{}}:{"Content-Type":"application/json",...t.headers||{}},a=await fetch(l,{...t,headers:s});if(!a.ok){let e=a.statusText;try{let t=await a.json();e=(null==t?void 0:t.message)||e}catch(e){}throw Error(e||"Request failed")}return 204===a.status?null:await a.json()}function a(e){return s(e,{method:"GET"})}function i(e,t){return s(e,{method:"POST",body:JSON.stringify(t)})}function n(e,t){return s(e,{method:"POST",body:t})}function r(e){return s(e,{method:"DELETE"})}l.d(t,{QW:function(){return r},R1:function(){return a},sg:function(){return i},zi:function(){return n}})}},function(e){e.O(0,[428,293,286,744],function(){return e(e.s=2945)}),_N_E=e.O()}]);