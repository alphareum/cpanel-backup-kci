(()=>{var e={};e.id=565,e.ids=[565],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2450:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),a(3345),a(9115),a(3358),a(7824);var s=a(3282),i=a(5736),n=a(3906),r=a.n(n),l=a(6880),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["admin",{children:["media",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3345)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\media\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,9115)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\layout.js"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,3358)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,7824,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\media\\page.js"],u="/admin/media/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/media/page",pathname:"/admin/media",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5786:(e,t,a)=>{Promise.resolve().then(a.bind(a,2802))},3009:(e,t,a)=>{Promise.resolve().then(a.bind(a,447))},8412:()=>{},4090:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,4424,23)),Promise.resolve().then(a.t.bind(a,7752,23)),Promise.resolve().then(a.t.bind(a,5275,23)),Promise.resolve().then(a.t.bind(a,9842,23)),Promise.resolve().then(a.t.bind(a,1633,23)),Promise.resolve().then(a.t.bind(a,9224,23))},2802:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(3227),i=a(649),n=a(1043),r=a(3677),l=a(4707);let o=[{href:"/admin/posts",label:"Posts"},{href:"/admin/events",label:"Events"},{href:"/admin/media",label:"Media"},{href:"/admin/contacts",label:"Contacts"},{href:"/admin/links",label:"Links"},{href:"/admin/messages",label:"Messages"}];function d({children:e}){let t=(0,n.usePathname)(),a=(0,n.useRouter)(),[d,c]=(0,r.useState)(!1);return d?(0,s.jsxs)("div",{children:[s.jsx("nav",{className:"admin-nav",children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("ul",{children:o.map(e=>{let a=t?.startsWith(e.href);return s.jsx("li",{children:s.jsx(i.default,{href:e.href,className:a?"active":void 0,children:e.label})},e.href)})}),s.jsx("div",{style:{paddingRight:"1.5rem"},children:s.jsx("button",{className:"button secondary",onClick:function(){(0,l.Ov)(),a.replace("/login")},children:"Sign out"})})]})}),s.jsx("main",{children:e})]}):null}},447:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(3227),i=a(3677),n=a(3083);function r({label:e="Metadata",value:t,onChange:a}){let n=(0,i.useMemo)(()=>{let e=t&&"object"==typeof t?Object.entries(t).map(([e,t])=>({key:e,value:t})):[];return 0===e.length?[{key:"",value:""}]:e},[t]);function r(e,t,a){l(n.map((s,i)=>i===e?{...s,[t]:a}:s))}function l(e){a(e.filter(e=>""!==e.key.trim()).reduce((e,t)=>(e[t.key]=t.value,e),{}))}return(0,s.jsxs)("div",{className:"stack",children:[s.jsx("span",{style:{fontWeight:600},children:e}),s.jsx("div",{className:"metadata-grid",children:n.map((e,t)=>(0,s.jsxs)("div",{className:"metadata-row",children:[s.jsx("input",{type:"text",placeholder:"Key",value:e.key,onChange:e=>r(t,"key",e.target.value)}),s.jsx("input",{type:"text",placeholder:"Value",value:e.value,onChange:e=>r(t,"value",e.target.value)}),s.jsx("button",{type:"button",className:"button secondary",onClick:()=>(function(e){let t=n.filter((t,a)=>a!==e);l(t.length?t:[{key:"",value:""}])})(t),children:"Remove"})]},t))}),s.jsx("div",{children:s.jsx("button",{type:"button",className:"button",onClick:function(){l([...n,{key:"",value:""}])},children:"Add metadata"})})]})}var l=a(4985);let o=[{type:"gallery",label:"Gallery"},{type:"testimonial",label:"Testimonials"},{type:"partner",label:"Partners"}];function d(e){return{id:null,type:e,title:"",description:"",asset_url:"",metadata:{}}}function c(){let[e,t]=(0,i.useState)(o[0].type),a=`/media/${e}`,{data:c,error:u,isLoading:m,mutate:p}=(0,n.ZP)(a,()=>(0,l.R1)(a)),h=(0,i.useMemo)(()=>c?.items??[],[c]),[y,f]=(0,i.useState)(!1),[b,x]=(0,i.useState)(()=>d(e)),[g,v]=(0,i.useState)(""),[j,k]=(0,i.useState)(!1),[C,w]=(0,i.useState)(!1),[N,P]=(0,i.useState)(!1),_=(0,i.useRef)(null),[D,S]=(0,i.useState)(null),[R,O]=(0,i.useState)(null);function U(){w(!1),P(!1),_.current&&(_.current.value="")}function E(){f(!1),k(!1),v(""),U()}function G(e,t){x(a=>({...a,[e]:t}))}let T=(0,i.useCallback)((e,t={})=>{x(a=>{let s={...a.metadata||{}};return s.uploaded_file_url=e,t.originalName&&(s.original_filename=t.originalName),t.mimeType&&(s.upload_mime_type=t.mimeType),void 0!==t.size&&(s.upload_file_size=String(t.size)),t.storage&&(s.upload_storage=t.storage),t.storageKey&&(s.upload_storage_key=t.storageKey),t.folder&&(s.upload_folder=t.folder),{...a,asset_url:e,metadata:s}})},[]),q=(0,i.useCallback)(async e=>{if(e&&!C){w(!0),v("");try{let t=new FormData;t.append("file",e),t.append("type",b.type);let a=await (0,l.zi)("/media/upload",t);T(a.url,a.metadata||{}),v("")}catch(e){v(e.message||"Failed to upload file")}finally{w(!1),P(!1),_.current&&(_.current.value="")}}},[T,b.type,C]),M=(0,i.useCallback)(e=>{let[t]=e.target.files||[];t&&!C&&q(t)},[q,C]),L=(0,i.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),P(!1),C)return;let t=e.dataTransfer?.files?.[0];t&&q(t)},[q,C]),A=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),C||P(!0)},[C]),F=(0,i.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),P(!1)},[]),z=(0,i.useCallback)(()=>{C||_.current?.click()},[C]);async function H(e){if(e.preventDefault(),C){v("Please wait for the upload to finish before saving.");return}let t=b.asset_url?.trim()??"";if(!t){v("Please provide an asset URL or upload a file before saving.");return}if(!function(e){if(!e)return!1;let t=e.trim();if(!t)return!1;if(t.startsWith("/"))return!0;try{let e=new URL(t);return!!e.protocol&&!!e.hostname}catch(e){return!1}}(t)){v("Please provide a valid URL or uploaded file path (starting with /).");return}k(!0),v("");let a={id:b.id??void 0,type:b.type,title:b.title||null,description:b.description||null,asset_url:t,metadata:Object.keys(b.metadata||{}).length?b.metadata:null};try{await (0,l.sg)("/media",a),await p(),E()}catch(e){v(e.message||"Failed to save media item")}finally{k(!1)}}async function I(){if(R){S(R.id);try{await (0,l.QW)(`/media/${R.id}`),await p(),O(null)}catch(e){alert(e.message||"Failed to delete media item")}finally{S(null)}}}return(0,s.jsxs)("section",{children:[(0,s.jsxs)("header",{className:"action-bar",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{style:{margin:0},children:"Media Library"}),s.jsx("p",{style:{margin:0,color:"#555"},children:"Upload links for gallery images, testimonials, and partner logos."})]}),s.jsx("button",{className:"button",onClick:function(){x(d(e)),v(""),f(!0),U()},children:"New asset"})]}),s.jsx("div",{className:"tabs",role:"tablist",children:o.map(a=>s.jsx("button",{type:"button",role:"tab","aria-selected":e===a.type,className:`tab ${e===a.type?"active":""}`,onClick:()=>{var e;t(e=a.type),f(!1),x(d(e)),v(""),U()},children:a.label},a.type))}),u?s.jsx("div",{className:"alert",children:u.message}):null,m?s.jsx("p",{children:"Loading media…"}):0===h.length?s.jsx("div",{className:"empty-state",children:"No media yet. Add your first item."}):s.jsx("div",{className:"list",children:h.map(e=>s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"stack",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[(0,s.jsxs)("div",{className:"stack",style:{gap:"0.35rem"},children:[s.jsx("h2",{style:{margin:0},children:e.title||"Untitled"}),s.jsx("p",{style:{margin:0,color:"#555"},children:e.description||"—"}),s.jsx("a",{href:e.asset_url,target:"_blank",rel:"noreferrer",children:e.asset_url})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[s.jsx("button",{className:"button secondary",onClick:()=>{x({id:e.id,type:e.type,title:e.title??"",description:e.description??"",asset_url:e.asset_url??"",metadata:e.metadata??{}}),v(""),f(!0),U()},children:"Edit"}),s.jsx("button",{className:"button secondary",onClick:()=>{O(e)},disabled:D===e.id,children:D===e.id?"Deleting…":"Delete"})]})]}),e.metadata?(0,s.jsxs)("div",{style:{fontSize:"0.85rem",color:"#555"},children:[s.jsx("strong",{children:"Metadata:"})," ",Object.entries(e.metadata).map(([e,t])=>(0,s.jsxs)("span",{style:{marginRight:"0.75rem"},children:[e,": ",String(t)]},e))]}):null]})},e.id))}),R?s.jsx("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"modal",style:{maxWidth:"480px"},children:[(0,s.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[s.jsx("h2",{style:{margin:0},children:"Remove asset?"}),(0,s.jsxs)("p",{style:{margin:0,color:"#555"},children:["Are you sure you want to remove “",R.title||R.asset_url,"” from the media library? This action cannot be undone."]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:[s.jsx("button",{type:"button",className:"button secondary",onClick:function(){D||O(null)},disabled:!!D,children:"Cancel"}),s.jsx("button",{type:"button",className:"button",onClick:I,disabled:!!D,children:R&&D===R.id?"Deleting…":"Remove"})]})]})}):null,y?s.jsx("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"modal",children:[(0,s.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[s.jsx("h2",{style:{margin:0},children:b.id?"Edit asset":"Add asset"}),s.jsx("p",{style:{margin:0,color:"#555"},children:"Provide the public URL for the media and optional metadata (alt text, credits, etc.)."})]}),g?s.jsx("div",{className:"alert",children:g}):null,(0,s.jsxs)("form",{className:"stack",onSubmit:H,children:[(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"media-title",children:"Title"}),s.jsx("input",{id:"media-title",type:"text",value:b.title,onChange:e=>G("title",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"media-type",children:"Type"}),s.jsx("select",{id:"media-type",value:b.type,onChange:e=>G("type",e.target.value),children:o.map(e=>s.jsx("option",{value:e.type,children:e.label},e.type))})]})]}),(0,s.jsxs)("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"media-description",children:"Description"}),s.jsx("textarea",{id:"media-description",rows:2,value:b.description,onChange:e=>G("description",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[s.jsx("label",{children:"Upload asset"}),(0,s.jsxs)("div",{role:"button",tabIndex:0,onClick:z,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),z())},onDragEnter:A,onDragOver:A,onDragLeave:F,onDrop:L,style:{border:"2px dashed",borderColor:N?"#1f6feb":"#d0d7de",borderRadius:"0.75rem",padding:"1.5rem",textAlign:"center",background:N?"#f0f6ff":"#f9fafb",cursor:C?"progress":"pointer",opacity:C?.75:1,transition:"all 0.2s ease-in-out",outline:"none"},children:[s.jsx("input",{ref:_,type:"file",accept:"image/*",style:{display:"none"},onChange:M}),(0,s.jsxs)("div",{className:"stack",style:{gap:"0.35rem",alignItems:"center"},children:[s.jsx("strong",{children:C?"Uploading…":"Drag and drop or click to select a file"}),s.jsx("span",{style:{fontSize:"0.85rem",color:"#555"},children:"We'll host this asset and provide a reusable public link."}),b.asset_url?(0,s.jsxs)("span",{style:{fontSize:"0.85rem",color:"#1f6feb",wordBreak:"break-word"},children:["Current URL: ",b.asset_url]}):null]})]}),s.jsx("span",{style:{fontSize:"0.8rem",color:"#555"},children:"Prefer an external resource? Paste its link below."})]}),(0,s.jsxs)("div",{className:"input-group",children:[s.jsx("label",{htmlFor:"media-url",children:"Asset URL"}),s.jsx("input",{id:"media-url",type:"text",value:b.asset_url,onChange:e=>G("asset_url",e.target.value)})]}),s.jsx(r,{value:b.metadata,onChange:e=>G("metadata",e)}),(0,s.jsxs)("div",{className:"actions",children:[s.jsx("button",{type:"button",className:"button secondary",onClick:E,disabled:j||C,children:"Cancel"}),s.jsx("button",{type:"submit",className:"button",disabled:j||C,children:j?"Saving…":"Save asset"})]})]})]})}):null]})}},4985:(e,t,a)=>{"use strict";async function s(e,t={}){let a=`https://api.komunitaschineseindonesia.com${e}`,s="undefined"!=typeof FormData&&t.body instanceof FormData?{...t.headers||{}}:{"Content-Type":"application/json",...t.headers||{}},i=await fetch(a,{...t,headers:s});if(!i.ok){let e=i.statusText;try{let t=await i.json();e=t?.message||e}catch(e){}throw Error(e||"Request failed")}return 204===i.status?null:await i.json()}function i(e){return s(e,{method:"GET"})}function n(e,t){return s(e,{method:"POST",body:JSON.stringify(t)})}function r(e,t){return s(e,{method:"POST",body:t})}function l(e){return s(e,{method:"DELETE"})}a.d(t,{QW:()=>l,R1:()=>i,sg:()=>n,zi:()=>r})},4707:(e,t,a)=>{"use strict";function s(e){}function i(){}a.d(t,{Ov:()=>i,ed:()=>s})},1043:(e,t,a)=>{"use strict";var s=a(2854);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},9115:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>r,__esModule:()=>n,default:()=>l});var s=a(3189);let i=(0,s.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\layout.js`),{__esModule:n,$$typeof:r}=i;i.default;let l=(0,s.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\layout.js#default`)},3345:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>r,__esModule:()=>n,default:()=>l});var s=a(3189);let i=(0,s.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\media\page.js`),{__esModule:n,$$typeof:r}=i;i.default;let l=(0,s.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\media\page.js#default`)},3358:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n,metadata:()=>i});var s=a(9013);a(1);let i={title:{default:"Komunitas Chinese Indonesia",template:"%s — Komunitas Chinese Indonesia"},description:"Komunitas Chinese Indonesia (KCI) menjadi ruang kolaborasi untuk melestarikan budaya dan menggerakkan komunitas."};function n({children:e}){return s.jsx("html",{lang:"id",children:s.jsx("body",{children:e})})}},1:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[592,649,83],()=>a(2450));module.exports=s})();