(()=>{var e={};e.id=667,e.ids=[667],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7750:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>r.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),t(7015),t(9115),t(3358),t(7824);var a=t(3282),i=t(5736),l=t(3906),r=t.n(l),n=t(6880),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["admin",{children:["posts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7015)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\posts\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9115)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\layout.js"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,3358)),"C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7824,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\alpha\\OneDrive\\Documents\\GitHub\\website-kci\\apps\\web\\app\\admin\\posts\\page.js"],c="/admin/posts/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/posts/page",pathname:"/admin/posts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9442:(e,s,t)=>{Promise.resolve().then(t.bind(t,9368))},9368:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var a=t(3227),i=t(3677),l=t(3083),r=t(2429),n=t(8770),o=t(4985);function d(){return{title:"",slug:"",summary:"",body:"",cover_image_url:"",published_at:"",is_published:!1}}function u(){let e="/posts?includeDrafts=1",{data:s,error:t,isLoading:u,mutate:c}=(0,l.ZP)(e,()=>(0,o.R1)(e)),p=(0,i.useMemo)(()=>s?.posts??[],[s]),[m,h]=(0,i.useState)(!1),[b,g]=(0,i.useState)(""),[x,j]=(0,i.useState)(!1),[y,v]=(0,i.useState)(()=>d()),[_,f]=(0,i.useState)(null),[w,N]=(0,i.useState)(!1),[C,S]=(0,i.useState)(null),k=(0,i.useId)(),P=`${k}-help`;function D(){h(!1),j(!1),g("")}function q(e,s){v(t=>({...t,[e]:s}))}async function F(e){e.preventDefault(),j(!0),g("");let s={id:_??void 0,title:y.title,slug:y.slug,summary:y.summary||null,body:y.body,cover_image_url:y.cover_image_url||null,is_published:y.is_published,published_at:function(e){if(!e)return null;let s=new Date(`${e}T00:00:00.000Z`);return Number.isNaN(s.getTime())?null:s.toISOString()}(y.published_at)};try{await (0,o.sg)("/posts",s),await c(),D()}catch(e){g(e.message||"Failed to save post")}finally{j(!1)}}async function G(e){let s=!e.is_published,t=s?e.published_at||new Date().toISOString():e.published_at||null;try{await (0,o.sg)("/posts",{id:e.id,title:e.title,slug:e.slug,summary:e.summary??null,body:e.body,cover_image_url:e.cover_image_url??null,is_published:s,published_at:t}),await c()}catch(e){alert(e.message||"Failed to update publish status")}}async function T(e){if(window.confirm(`Delete post "${e.title}"? This action cannot be undone.`)){S(e.id);try{await (0,o.QW)(`/posts/${e.id}`),await c()}catch(e){alert(e.message||"Failed to delete post")}finally{S(null)}}}return(0,a.jsxs)("section",{children:[(0,a.jsxs)("header",{className:"action-bar",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{style:{margin:0},children:"Posts"}),a.jsx("p",{style:{margin:0,color:"#555"},children:"Create and manage blog entries. Publish posts to make them visible on the public blog."})]}),a.jsx("button",{className:"button",onClick:function(){v(d()),f(null),g(""),h(!0)},children:"New post"})]}),t?a.jsx("div",{className:"alert",children:t.message}):null,u?a.jsx("p",{children:"Loading posts…"}):0===p.length?a.jsx("div",{className:"empty-state",children:"No posts yet. Start by creating a new post."}):(0,a.jsxs)("table",{className:"table",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{children:"Title"}),a.jsx("th",{children:"Published on"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:p.map(e=>(0,a.jsxs)("tr",{children:[a.jsx("td",{children:(0,a.jsxs)("div",{className:"stack",children:[a.jsx("strong",{children:e.title}),a.jsx("span",{style:{color:"#666",fontSize:"0.875rem"},children:e.slug})]})}),a.jsx("td",{children:e.published_at?new Date(e.published_at).toLocaleDateString("en-US",{timeZone:"Asia/Jakarta"}):"—"}),a.jsx("td",{children:a.jsx("span",{className:"badge",style:{background:e.is_published?"#dcfce7":"#fee2e2",color:e.is_published?"#166534":"#7f1d1d"},children:e.is_published?"Published":"Draft"})}),a.jsx("td",{children:(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[a.jsx("button",{className:"button secondary",onClick:()=>{v({...e,summary:e.summary??"",body:e.body??"",cover_image_url:e.cover_image_url??"",published_at:function(e){if(!e)return"";let s=new Date(e);if(Number.isNaN(s.getTime()))return"";let t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return`${t}-${a}-${i}`}(e.published_at)}),f(e.id),g(""),h(!0)},children:"Edit"}),a.jsx("button",{className:"button",onClick:()=>G(e),children:e.is_published?"Unpublish":"Publish"}),a.jsx("button",{className:"button secondary",onClick:()=>T(e),disabled:C===e.id,children:C===e.id?"Deleting…":"Delete"})]})})]},e.id))})]}),m?a.jsx("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,a.jsxs)("div",{className:"modal",style:{maxWidth:"720px"},children:[(0,a.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[a.jsx("h2",{style:{margin:0},children:_?"Edit post":"Create post"}),a.jsx("p",{style:{margin:0,color:"#555"},children:"Provide the post details below. The publish date helps order posts on the public blog."})]}),b?a.jsx("div",{className:"alert",children:b}):null,(0,a.jsxs)("form",{className:"form-grid",onSubmit:F,children:[(0,a.jsxs)("div",{className:"form-grid two-col",children:[(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"title",children:"Title"}),a.jsx("input",{id:"title",type:"text",required:!0,value:y.title,onChange:e=>q("title",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"slug",children:"Slug"}),a.jsx("input",{id:"slug",type:"text",required:!0,value:y.slug,onChange:e=>q("slug",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"summary",children:"Summary"}),a.jsx("textarea",{id:"summary",rows:3,value:y.summary,onChange:e=>q("summary",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"body",children:"Body"}),a.jsx("textarea",{id:"body",rows:10,required:!0,value:y.body,onChange:e=>q("body",e.target.value)})]}),(0,a.jsxs)("div",{className:"form-grid two-col",children:[(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{htmlFor:"published_at",children:"Publish date"}),a.jsx("input",{id:"published_at",type:"date",value:y.published_at,onChange:e=>q("published_at",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[a.jsx("label",{id:k,htmlFor:"cover_image",children:"Cover image"}),a.jsx(n.C,{value:y.cover_image_url,onChange:e=>q("cover_image_url",e),uploadType:"posts",ariaLabelledBy:k,ariaDescribedBy:P,disabled:x,helperText:"Upload a new cover image for this post."}),a.jsx("span",{id:P,style:{fontSize:"0.8rem",color:"#555"},children:"Prefer an external resource? Paste its link below or pick an existing asset."}),(0,a.jsxs)("div",{className:"stack",style:{gap:"0.5rem"},children:[a.jsx("input",{id:"cover_image",type:"text",placeholder:"https://example.com/image.jpg or /uploads/example.jpg",value:y.cover_image_url,onChange:e=>q("cover_image_url",e.target.value)}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[a.jsx("button",{type:"button",className:"button secondary",onClick:()=>N(!0),children:"Choose from media library"}),y.cover_image_url?a.jsx("button",{type:"button",className:"button secondary",onClick:()=>q("cover_image_url",""),children:"Remove image"}):null]}),y.cover_image_url?a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.75rem",overflow:"hidden",width:"100%",maxWidth:"320px"},children:a.jsx("img",{src:y.cover_image_url,alt:"Selected cover",style:{width:"100%",display:"block",objectFit:"cover"}})}):null]})]})]}),(0,a.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("input",{type:"checkbox",checked:y.is_published,onChange:e=>q("is_published",e.target.checked)}),a.jsx("span",{children:"Published"})]}),(0,a.jsxs)("div",{className:"actions",children:[a.jsx("button",{type:"button",className:"button secondary",onClick:D,disabled:x,children:"Cancel"}),a.jsx("button",{type:"submit",className:"button",disabled:x,children:x?"Saving…":"Save post"})]})]})]})}):null,a.jsx(r.R,{open:w,onClose:()=>N(!1),onSelect:function(e){e&&(q("cover_image_url",e.asset_url||""),N(!1))}})]})}},7015:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>r,__esModule:()=>l,default:()=>n});var a=t(3189);let i=(0,a.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\posts\page.js`),{__esModule:l,$$typeof:r}=i;i.default;let n=(0,a.createProxy)(String.raw`C:\Users\alpha\OneDrive\Documents\GitHub\website-kci\apps\web\app\admin\posts\page.js#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[592,649,83,558],()=>t(7750));module.exports=a})();