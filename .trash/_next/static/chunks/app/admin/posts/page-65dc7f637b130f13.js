(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{2945:function(e,t,l){Promise.resolve().then(l.bind(l,7278))},7278:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return c}});var a=l(7573),s=l(7653),i=l(8428),n=l(3978),r=l(7118),o=l(7656);function d(){return{title:"",slug:"",summary:"",body:"",cover_image_url:"",published_at:"",is_published:!1}}function c(){let e="/posts?includeDrafts=1",{data:t,error:l,isLoading:c,mutate:u}=(0,i.ZP)(e,()=>(0,o.R1)(e)),m=(0,s.useMemo)(()=>{var e;return null!==(e=null==t?void 0:t.posts)&&void 0!==e?e:[]},[t]),[h,p]=(0,s.useState)(!1),[b,g]=(0,s.useState)(""),[x,y]=(0,s.useState)(!1),[v,f]=(0,s.useState)(()=>d()),[j,_]=(0,s.useState)(null),[N,k]=(0,s.useState)(!1),[w,C]=(0,s.useState)(null),S=(0,s.useId)(),D="".concat(S,"-help");function P(){p(!1),y(!1),g("")}function T(e,t){f(l=>({...l,[e]:t}))}async function E(e){e.preventDefault(),y(!0),g("");let t={id:null!=j?j:void 0,title:v.title,slug:v.slug,summary:v.summary||null,body:v.body,cover_image_url:v.cover_image_url||null,is_published:v.is_published,published_at:function(e){if(!e)return null;let t=new Date("".concat(e,"T00:00:00.000Z"));return Number.isNaN(t.getTime())?null:t.toISOString()}(v.published_at)};try{await (0,o.sg)("/posts",t),await u(),P()}catch(e){g(e.message||"Failed to save post")}finally{y(!1)}}async function F(e){let t=!e.is_published,l=t?e.published_at||new Date().toISOString():e.published_at||null;try{var a,s;await (0,o.sg)("/posts",{id:e.id,title:e.title,slug:e.slug,summary:null!==(a=e.summary)&&void 0!==a?a:null,body:e.body,cover_image_url:null!==(s=e.cover_image_url)&&void 0!==s?s:null,is_published:t,published_at:l}),await u()}catch(e){alert(e.message||"Failed to update publish status")}}async function R(e){if(window.confirm('Delete post "'.concat(e.title,'"? This action cannot be undone.'))){C(e.id);try{await (0,o.QW)("/posts/".concat(e.id)),await u()}catch(e){alert(e.message||"Failed to delete post")}finally{C(null)}}}return(0,a.jsxs)("section",{children:[(0,a.jsxs)("header",{className:"action-bar",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{style:{margin:0},children:"Posts"}),(0,a.jsx)("p",{style:{margin:0,color:"#555"},children:"Create and manage blog entries. Publish posts to make them visible on the public blog."})]}),(0,a.jsx)("button",{className:"button",onClick:function(){f(d()),_(null),g(""),p(!0)},children:"New post"})]}),l?(0,a.jsx)("div",{className:"alert",children:l.message}):null,c?(0,a.jsx)("p",{children:"Loading posts…"}):0===m.length?(0,a.jsx)("div",{className:"empty-state",children:"No posts yet. Start by creating a new post."}):(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Title"}),(0,a.jsx)("th",{children:"Published on"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:m.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"stack",children:[(0,a.jsx)("strong",{children:e.title}),(0,a.jsx)("span",{style:{color:"#666",fontSize:"0.875rem"},children:e.slug})]})}),(0,a.jsx)("td",{children:e.published_at?new Date(e.published_at).toLocaleDateString("en-US",{timeZone:"Asia/Jakarta"}):"—"}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge",style:{background:e.is_published?"#dcfce7":"#fee2e2",color:e.is_published?"#166534":"#7f1d1d"},children:e.is_published?"Published":"Draft"})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,a.jsx)("button",{className:"button secondary",onClick:()=>{var t,l,a;f({...e,summary:null!==(t=e.summary)&&void 0!==t?t:"",body:null!==(l=e.body)&&void 0!==l?l:"",cover_image_url:null!==(a=e.cover_image_url)&&void 0!==a?a:"",published_at:function(e){if(!e)return"";let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let l=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return"".concat(l,"-").concat(a,"-").concat(s)}(e.published_at)}),_(e.id),g(""),p(!0)},children:"Edit"}),(0,a.jsx)("button",{className:"button",onClick:()=>F(e),children:e.is_published?"Unpublish":"Publish"}),(0,a.jsx)("button",{className:"button secondary",onClick:()=>R(e),disabled:w===e.id,children:w===e.id?"Deleting…":"Delete"})]})})]},e.id))})]}),h?(0,a.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,a.jsxs)("div",{className:"modal",style:{maxWidth:"720px"},children:[(0,a.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[(0,a.jsx)("h2",{style:{margin:0},children:j?"Edit post":"Create post"}),(0,a.jsx)("p",{style:{margin:0,color:"#555"},children:"Provide the post details below. The publish date helps order posts on the public blog."})]}),b?(0,a.jsx)("div",{className:"alert",children:b}):null,(0,a.jsxs)("form",{className:"form-grid",onSubmit:E,children:[(0,a.jsxs)("div",{className:"form-grid two-col",children:[(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{htmlFor:"title",children:"Title"}),(0,a.jsx)("input",{id:"title",type:"text",required:!0,value:v.title,onChange:e=>T("title",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{htmlFor:"slug",children:"Slug"}),(0,a.jsx)("input",{id:"slug",type:"text",required:!0,value:v.slug,onChange:e=>T("slug",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{htmlFor:"summary",children:"Summary"}),(0,a.jsx)("textarea",{id:"summary",rows:3,value:v.summary,onChange:e=>T("summary",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{htmlFor:"body",children:"Body"}),(0,a.jsx)("textarea",{id:"body",rows:10,required:!0,value:v.body,onChange:e=>T("body",e.target.value)})]}),(0,a.jsxs)("div",{className:"form-grid two-col",children:[(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{htmlFor:"published_at",children:"Publish date"}),(0,a.jsx)("input",{id:"published_at",type:"date",value:v.published_at,onChange:e=>T("published_at",e.target.value)})]}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("label",{id:S,htmlFor:"cover_image",children:"Cover image"}),(0,a.jsx)(r.C,{value:v.cover_image_url,onChange:e=>T("cover_image_url",e),uploadType:"posts",ariaLabelledBy:S,ariaDescribedBy:D,disabled:x,helperText:"Upload a new cover image for this post."}),(0,a.jsx)("span",{id:D,style:{fontSize:"0.8rem",color:"#555"},children:"Prefer an external resource? Paste its link below or pick an existing asset."}),(0,a.jsxs)("div",{className:"stack",style:{gap:"0.5rem"},children:[(0,a.jsx)("input",{id:"cover_image",type:"text",placeholder:"https://example.com/image.jpg or /uploads/example.jpg",value:v.cover_image_url,onChange:e=>T("cover_image_url",e.target.value)}),(0,a.jsxs)("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:()=>k(!0),children:"Choose from media library"}),v.cover_image_url?(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:()=>T("cover_image_url",""),children:"Remove image"}):null]}),v.cover_image_url?(0,a.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"0.75rem",overflow:"hidden",width:"100%",maxWidth:"320px"},children:(0,a.jsx)("img",{src:v.cover_image_url,alt:"Selected cover",style:{width:"100%",display:"block",objectFit:"cover"}})}):null]})]})]}),(0,a.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,a.jsx)("input",{type:"checkbox",checked:v.is_published,onChange:e=>T("is_published",e.target.checked)}),(0,a.jsx)("span",{children:"Published"})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:P,disabled:x,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"button",disabled:x,children:x?"Saving…":"Save post"})]})]})]})}):null,(0,a.jsx)(n.R,{open:N,onClose:()=>k(!1),onSelect:function(e){e&&(T("cover_image_url",e.asset_url||""),k(!1))}})]})}},7118:function(e,t,l){"use strict";l.d(t,{C:function(){return n}});var a=l(7573),s=l(7653),i=l(7656);function n(e){let{value:t,onChange:l,uploadType:n="media",disabled:r=!1,helperText:o="We'll host this image and return a reusable link.",ariaLabelledBy:d,ariaDescribedBy:c}=e,[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(""),[b,g]=(0,s.useState)(!1),x=(0,s.useRef)(null),y=(0,s.useCallback)(()=>{x.current&&(x.current.value="")},[]),v=(0,s.useCallback)(async e=>{if(e&&!r&&!u){m(!0),p("");try{let t=new FormData;t.append("file",e),t.append("type",n);let a=await (0,i.zi)("/media/upload",t);l(a.url)}catch(e){p(e.message||"Failed to upload image")}finally{m(!1),g(!1),y()}}},[r,l,y,n,u]),f=(0,s.useCallback)(e=>{var t,l;if(e.preventDefault(),e.stopPropagation(),r||u)return;g(!1);let a=null===(l=e.dataTransfer)||void 0===l?void 0:null===(t=l.files)||void 0===t?void 0:t[0];a&&v(a)},[r,v,u]),j=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),r||u||g(!0)},[r,u]),_=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g(!1)},[]),N=(0,s.useCallback)(()=>{var e;r||u||null===(e=x.current)||void 0===e||e.click()},[r,u]),k=(0,s.useCallback)(e=>{let[t]=e.target.files||[];t&&v(t)},[v]);return(0,a.jsxs)("div",{className:"stack",style:{gap:"0.5rem"},children:[(0,a.jsxs)("div",{role:"button",tabIndex:0,onClick:N,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),N())},onDragEnter:j,onDragOver:j,onDragLeave:_,onDrop:f,"aria-disabled":r||u,"aria-busy":u,"aria-labelledby":d,"aria-describedby":c,style:{border:"2px dashed",borderColor:b?"#1f6feb":"#d0d7de",borderRadius:"0.75rem",padding:"1.25rem",textAlign:"center",background:b?"#f0f6ff":"#f9fafb",cursor:r||u?"not-allowed":"pointer",opacity:r?.6:1,outline:"none",transition:"all 0.2s ease-in-out"},children:[(0,a.jsx)("input",{ref:x,type:"file",accept:"image/*",style:{display:"none"},onChange:k,disabled:r||u}),(0,a.jsxs)("div",{className:"stack",style:{gap:"0.25rem",alignItems:"center"},children:[(0,a.jsx)("strong",{children:u?"Uploading…":"Drag and drop or click to upload an image"}),(0,a.jsx)("span",{style:{fontSize:"0.85rem",color:"#555"},children:o}),t?(0,a.jsxs)("span",{style:{fontSize:"0.85rem",color:"#1f6feb",wordBreak:"break-word"},children:["Current URL: ",t]}):null]})]}),h?(0,a.jsx)("div",{className:"alert",children:h}):null]})}},3978:function(e,t,l){"use strict";l.d(t,{R:function(){return d}});var a=l(7573),s=l(7653),i=l(8428),n=l(7656);let r=[{value:"testimonial",label:"Testimonials"},{value:"partner",label:"Partners"},{value:"gallery",label:"Gallery"}];function o(e){let{type:t,onSelect:l}=e,{data:r,error:o,isLoading:d}=(0,i.ZP)("/media/".concat(t),()=>(0,n.R1)("/media/".concat(t))),c=(0,s.useMemo)(()=>{var e;return null!==(e=null==r?void 0:r.items)&&void 0!==e?e:[]},[r]);return o?(0,a.jsx)("div",{className:"alert",children:o.message}):d?(0,a.jsx)("p",{children:"Loading media…"}):0===c.length?(0,a.jsx)("div",{className:"empty-state",children:"No media in this group yet."}):(0,a.jsx)("div",{className:"stack",children:c.map(e=>(0,a.jsxs)("button",{type:"button",className:"card",style:{textAlign:"left",display:"grid",gridTemplateColumns:"96px 1fr auto",gap:"1rem",alignItems:"center"},onClick:()=>l(e),children:[(0,a.jsx)("div",{style:{width:"96px",height:"96px",borderRadius:"0.75rem",overflow:"hidden",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #e5e7eb"},children:e.asset_url?(0,a.jsx)("img",{src:e.asset_url,alt:e.title||"Media asset",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,a.jsx)("span",{style:{color:"#555"},children:"No preview"})}),(0,a.jsxs)("div",{className:"stack",style:{gap:"0.35rem"},children:[(0,a.jsx)("strong",{children:e.title||"Untitled asset"}),e.description?(0,a.jsx)("span",{style:{color:"#555"},children:e.description}):null,(0,a.jsx)("span",{style:{fontSize:"0.85rem",color:"#1f6feb",wordBreak:"break-all"},children:e.asset_url})]}),(0,a.jsx)("span",{className:"badge",style:{justifySelf:"flex-start"},children:"Select"})]},e.id))})}function d(e){var t,l;let{open:i,onClose:n,onSelect:d}=e,[c,u]=(0,s.useState)(null!==(l=null===(t=r[0])||void 0===t?void 0:t.value)&&void 0!==l?l:"testimonial");return((0,s.useEffect)(()=>{if(!i)return;let e=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,n]),i)?(0,a.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,a.jsxs)("div",{className:"modal",style:{maxWidth:"720px"},children:[(0,a.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[(0,a.jsx)("h2",{style:{margin:0},children:"Choose media"}),(0,a.jsx)("p",{style:{margin:0,color:"#555"},children:"Pick an image from the media library. You can manage assets from the Media section of the admin panel."})]}),(0,a.jsx)("div",{className:"tabs",role:"tablist",style:{marginBottom:"1rem"},children:r.map(e=>(0,a.jsx)("button",{type:"button",role:"tab","aria-selected":c===e.value,className:"tab ".concat(c===e.value?"active":""),onClick:()=>u(e.value),children:e.label},e.value))}),(0,a.jsx)("div",{style:{maxHeight:"420px",overflowY:"auto",paddingRight:"0.5rem"},children:(0,a.jsx)(o,{type:c,onSelect:e=>d(e)})}),(0,a.jsx)("footer",{style:{marginTop:"1rem",display:"flex",justifyContent:"flex-end"},children:(0,a.jsx)("button",{type:"button",className:"button secondary",onClick:n,children:"Close"})})]})}):null}},7656:function(e,t,l){"use strict";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l="".concat("http://127.0.0.1:3001/api").concat(e),a="undefined"!=typeof FormData&&t.body instanceof FormData?{...t.headers||{}}:{"Content-Type":"application/json",...t.headers||{}},s=await fetch(l,{...t,headers:a});if(!s.ok){let e=s.statusText;try{let t=await s.json();e=(null==t?void 0:t.message)||e}catch(e){}throw Error(e||"Request failed")}return 204===s.status?null:await s.json()}function s(e){return a(e,{method:"GET"})}function i(e,t){return a(e,{method:"POST",body:JSON.stringify(t)})}function n(e,t){return a(e,{method:"POST",body:t})}function r(e){return a(e,{method:"DELETE"})}l.d(t,{QW:function(){return r},R1:function(){return s},sg:function(){return i},zi:function(){return n}})}},function(e){e.O(0,[428,293,286,744],function(){return e(e.s=2945)}),_N_E=e.O()}]);