(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[206],{3514:function(e,t,n){Promise.resolve().then(n.bind(n,5206))},5206:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var s=n(7573),a=n(7653),i=n(8428),l=n(7656),r=n(5662);function o(){return{title:"",slug:"",summary:"",description:"",location:"",starts_at:(0,r.Nl)(new Date().toISOString()),ends_at:"",hero_image_url:"",is_published:!1}}function c(){let{data:e,error:t,isLoading:n,mutate:c}=(0,i.ZP)("/events",()=>(0,l.R1)("/events")),u=(0,a.useMemo)(()=>{var t;return null!==(t=null==e?void 0:e.events)&&void 0!==t?t:[]},[e]),[d,h]=(0,a.useState)(!1),[m,g]=(0,a.useState)(""),[p,v]=(0,a.useState)(!1),[x,j]=(0,a.useState)(()=>o()),[_,b]=(0,a.useState)(null);function f(){h(!1),v(!1),g("")}function y(e,t){j(n=>({...n,[e]:t}))}async function N(e){var t;e.preventDefault(),v(!0),g("");let n={id:null!=_?_:void 0,title:x.title,slug:x.slug,summary:x.summary||null,description:x.description||null,location:x.location||null,hero_image_url:x.hero_image_url||null,is_published:x.is_published,starts_at:null!==(t=(0,r.Iu)(x.starts_at))&&void 0!==t?t:new Date().toISOString(),ends_at:x.ends_at?(0,r.Iu)(x.ends_at):null};try{await (0,l.sg)("/events",n),await c(),f()}catch(e){g(e.message||"Failed to save event")}finally{v(!1)}}async function S(e){try{var t,n,s,a;await (0,l.sg)("/events",{...e,summary:null!==(t=e.summary)&&void 0!==t?t:null,description:null!==(n=e.description)&&void 0!==n?n:null,location:null!==(s=e.location)&&void 0!==s?s:null,hero_image_url:null!==(a=e.hero_image_url)&&void 0!==a?a:null,starts_at:e.starts_at,ends_at:e.ends_at,is_published:!e.is_published}),await c()}catch(e){alert(e.message||"Failed to update publish status")}}return(0,s.jsxs)("section",{children:[(0,s.jsxs)("header",{className:"action-bar",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{style:{margin:0},children:"Events"}),(0,s.jsx)("p",{style:{margin:0,color:"#555"},children:"Manage upcoming events. Toggle publish status to control visibility on the site."})]}),(0,s.jsx)("button",{className:"button",onClick:function(){j(o()),b(null),g(""),h(!0)},children:"New event"})]}),t?(0,s.jsx)("div",{className:"alert",children:t.message}):null,n?(0,s.jsx)("p",{children:"Loading events…"}):0===u.length?(0,s.jsx)("div",{className:"empty-state",children:"No events yet. Create your first event."}):(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Title"}),(0,s.jsx)("th",{children:"Starts"}),(0,s.jsx)("th",{children:"Ends"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:u.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"stack",children:[(0,s.jsx)("strong",{children:e.title}),(0,s.jsx)("span",{style:{color:"#666",fontSize:"0.875rem"},children:e.slug})]})}),(0,s.jsx)("td",{children:new Date(e.starts_at).toLocaleString("en-US",{timeZone:"Asia/Jakarta"})}),(0,s.jsx)("td",{children:e.ends_at?new Date(e.ends_at).toLocaleString("en-US",{timeZone:"Asia/Jakarta"}):"—"}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge",style:{background:e.is_published?"#dcfce7":"#fee2e2",color:e.is_published?"#166534":"#7f1d1d"},children:e.is_published?"Published":"Draft"})}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,s.jsx)("button",{className:"button secondary",onClick:()=>{var t,n,s,a;j({...e,summary:null!==(t=e.summary)&&void 0!==t?t:"",description:null!==(n=e.description)&&void 0!==n?n:"",location:null!==(s=e.location)&&void 0!==s?s:"",hero_image_url:null!==(a=e.hero_image_url)&&void 0!==a?a:"",starts_at:(0,r.Nl)(e.starts_at),ends_at:(0,r.Nl)(e.ends_at)}),b(e.id),g(""),h(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"button",onClick:()=>S(e),children:e.is_published?"Unpublish":"Publish"})]})})]},e.id))})]}),d?(0,s.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true",children:(0,s.jsxs)("div",{className:"modal",children:[(0,s.jsxs)("header",{className:"stack",style:{marginBottom:"1rem"},children:[(0,s.jsx)("h2",{style:{margin:0},children:_?"Edit event":"Create event"}),(0,s.jsx)("p",{style:{margin:0,color:"#555"},children:"Fill in the event details. Times are saved in Jakarta time (UTC+7)."})]}),m?(0,s.jsx)("div",{className:"alert",children:m}):null,(0,s.jsxs)("form",{className:"form-grid",onSubmit:N,children:[(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"title",children:"Title"}),(0,s.jsx)("input",{id:"title",type:"text",required:!0,value:x.title,onChange:e=>y("title",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"slug",children:"Slug"}),(0,s.jsx)("input",{id:"slug",type:"text",required:!0,value:x.slug,onChange:e=>y("slug",e.target.value)})]})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"summary",children:"Summary"}),(0,s.jsx)("textarea",{id:"summary",rows:2,value:x.summary,onChange:e=>y("summary",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"description",children:"Description"}),(0,s.jsx)("textarea",{id:"description",rows:4,value:x.description,onChange:e=>y("description",e.target.value)})]}),(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"location",children:"Location"}),(0,s.jsx)("input",{id:"location",type:"text",value:x.location,onChange:e=>y("location",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"hero",children:"Hero image URL"}),(0,s.jsx)("input",{id:"hero",type:"url",value:x.hero_image_url,onChange:e=>y("hero_image_url",e.target.value)})]})]}),(0,s.jsxs)("div",{className:"form-grid two-col",children:[(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"starts_at",children:"Starts at"}),(0,s.jsx)("input",{id:"starts_at",type:"datetime-local",required:!0,value:x.starts_at,onChange:e=>y("starts_at",e.target.value)})]}),(0,s.jsxs)("div",{className:"input-group",children:[(0,s.jsx)("label",{htmlFor:"ends_at",children:"Ends at"}),(0,s.jsx)("input",{id:"ends_at",type:"datetime-local",value:x.ends_at,onChange:e=>y("ends_at",e.target.value)})]})]}),(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,s.jsx)("input",{type:"checkbox",checked:x.is_published,onChange:e=>y("is_published",e.target.checked)}),(0,s.jsx)("span",{children:"Published"})]}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)("button",{type:"button",className:"button secondary",onClick:f,disabled:p,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"button",disabled:p,children:p?"Saving…":"Save event"})]})]})]})}):null]})}},7656:function(e,t,n){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat("https://api.komunitaschineseindonesia.com/api").concat(e),s="undefined"!=typeof FormData&&t.body instanceof FormData?{...t.headers||{}}:{"Content-Type":"application/json",...t.headers||{}},a=await fetch(n,{...t,headers:s});if(!a.ok){let e=a.statusText;try{let t=await a.json();e=(null==t?void 0:t.message)||e}catch(e){}throw Error(e||"Request failed")}return 204===a.status?null:await a.json()}function a(e){return s(e,{method:"GET"})}function i(e,t){return s(e,{method:"POST",body:JSON.stringify(t)})}function l(e,t){return s(e,{method:"POST",body:t})}function r(e){return s(e,{method:"DELETE"})}n.d(t,{QW:function(){return r},R1:function(){return a},sg:function(){return i},zi:function(){return l}})},5662:function(e,t,n){"use strict";function s(e){if(!e)return"";let t=new Date(new Date(e).toLocaleString("en-US",{timeZone:"Asia/Jakarta",hour12:!1})),n=e=>String(e).padStart(2,"0"),s=t.getFullYear(),a=n(t.getMonth()+1),i=n(t.getDate()),l=n(t.getHours()),r=n(t.getMinutes());return"".concat(s,"-").concat(a,"-").concat(i,"T").concat(l,":").concat(r)}function a(e){if(!e)return null;let[t,n]=e.split("T"),s=5===n.length?"".concat(n,":00"):n;return new Date("".concat(t,"T").concat(s,"+07:00")).toISOString()}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...e].sort((e,t)=>{var n,s;return(null!==(n=e.order)&&void 0!==n?n:0)-(null!==(s=t.order)&&void 0!==s?s:0)})}n.d(t,{HN:function(){return i},Iu:function(){return a},Nl:function(){return s}})}},function(e){e.O(0,[428,293,286,744],function(){return e(e.s=3514)}),_N_E=e.O()}]);